# 分布式

### 分布式ID

#### 雪花算法：

1.第一位 占用1bit，其值始终是0，没有实际作用。 2.时间戳 占用41bit，精确到毫秒，总共可以容纳约69年的时间。 3.工作机器id 占用10bit，其中高位5bit是数据中心ID，低位5bit是工作节点ID，做多可以容纳1024个节点。 4.序列号 占用12bit，每个节点每毫秒0开始不断累加，最多可以累加到4095，一共可以产生4096个ID&#x20;

SnowFlake算法在同一毫秒内最多可以生成多少个全局唯一ID呢：： 同一毫秒的ID数量 = 1024 X 4096 = 4194304

同一台服务器所有生成的 id 按时间趋势递增&#x20;

整个分布式系统内不会产生重复 id（因为有 datacenterId 和 workerId 来做区分）&#x20;

存在的问题：&#x20;

机器 ID（5 位）和数据中心 ID（5 位）配置没有解决，分布式部署的时候会使用相同的配置，任然有 ID 重复的风险。&#x20;

使用的时候需要实例化对象，没有形成开箱即用的工具类。

&#x20;强依赖机器时钟，如果机器上时钟回拨，会导致发号重复或者服务会处于不可用状态。（这点在正常情况下是不会发生的）
